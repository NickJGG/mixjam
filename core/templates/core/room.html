{% extends 'core/_base_auth.html' %}
{% load static %}

{% block title %}{{ room.title }}{% endblock %}

{% block css %}
	{{ block.super }}

	<link rel = "stylesheet" type = "text/css" href = "{% static 'css/room.css' %}">
	<link rel = "stylesheet" type = "text/css" href = "{% static 'css/settings.css' %}">

	{% if room.banner_color != None %}

		<style>
			:root{
				--banner-color: #{{ room.banner_color }};
			}
		</style>

	{% endif %}

{% endblock %}

{% block page_name %}{{ room.title }}{% endblock %}
{% block selected_rooms %}selected{% endblock %}
{% block selected_rooms2 %}selected{% endblock %}

{% block container %}

	{% if new_room %}

		<div id = "user-message-container">
			<div id = "new-user-message">
				<img src = "{{ room.playlist_image_url }}">
				
				{% if user == room.leader %}

					<p id = "message-title">Welcome to your new room</p>
					<p id = "message-body">Its a little lonely in here, why don't we change that?</p>
					<div id = "message-tips">
						<div class = "message-tip">Get the invite link by clicking on the link icon next to your room name</div>
						<div class = "message-tip">Click on any song to start playback for everyone</div>
						<div class = "message-tip">To change things like the privacy mode and banner color, head to the Settings tab</div>
						<div class = "message-tip">Make sure you're connected (top right corner) to use the controls</div>
					</div>
					<div class = "settings-actions">
						<input id = "close-message" class = "gray" type = "submit" value = "Got It">
					</div>

				{% else %}

					<p id = "message-title">Welcome to {{ room.title }}</p>
					<p id = "message-body">Put on some music and enjoy your stay</p>
					<div id = "message-tips">
						<div class = "message-tip">Click on any song to start playback for everyone</div>
						<div class = "message-tip">Make sure you're connected (top right corner) to use the controls</div>
					</div>
					<div class = "settings-actions">
						<input id = "close-message" class = "gray" type = "submit" value = "Got It">
					</div>

				{% endif %}
			</div>
		</div>

	{% endif %}

	<div id = "room-container">
		<div id = "room-info-container">
			<div id = "room-details">
				<div id = "room-cover">
					<img src = "{{ room.playlist_image_url }}">
				</div>
				<p id = "room-title">{{ room.title }}</p>
				<div id = "room-creator">
					<img class = "label-image" src = "{% static 'img/icons/crown-white-88.png' %}">

					{% include 'core/blocks/profile-picture.html' with profile=room.leader width='1.4em' height='1.4em' %}
					
					<p id = "creator-username">{{ room.leader.username }}</p>
				</div>
			</div>
		</div>
		<div id = "playlist-container">
			<div id = "playlist">
				
			</div>
		</div>
		<div id = "social-container">

		</div>
	</div>
	<div id = "player-container" class = "dropdown-container">
		<input type = "hidden" class = "dropdown-group" value = "1">
		<input type = "hidden" class = "dropdown-layer" value = "1">

		<div id = "mobile-player" class = "dropdown-element">
			<div id = "mp-header">
				<div>
					<div class = "player-element dropdown-close">
						<img src = "{% static 'img/icons/downarrow-white-72.png' %}">
					</div>
				</div>
				<div>
					<div class = "player-element">
						<img src = "{% static 'img/icons/spotify-80.png' %}">
					</div>
				</div>
			</div>
			<div id = "mp-body">
				<div class = "current-song-image">
					
				</div>
				<div id = "mp-details">
					<p class = "current-song-title"></p>
					<p class = "current-song-artist"></p>
				</div>
				<div class = "song-progress-container">
					<!-- <p class = "song-progress-time">- : - -</p> -->
					<p class = "song-progress-time">0:00</p>
					<div class = "song-progress progress-container row">
						<div class = "progress-complete">
							<div class = "progress-thumb">
								
							</div>
						</div>
						<div class = "progress-incomplete">
							
						</div>
					</div>
					<!-- <p class = "song-total-time">- : - -</p> -->
					<p class = "song-total-time">3:12</p>
				</div>
			</div>
			<div id = "mp-controls">
				<div class = "device-container dropdown-container column top right">
					<input type = "hidden" class = "dropdown-group" value = "1">
					<input type = "hidden" class = "dropdown-layer" value = "2">
				
					<div class = "dropdown-toggle player-element select-element icon-element">
						<img src = "{% static 'img/icons/device-white-96.png' %}">
					</div>
					<div class = "dropdown-element">
						<div class = "header no-margin">
							<div class = "header-info">
								<p>Devices</p>
							</div>
							<div class = "header-actions">
								<div class = "header-element nav-element refresh-devices">
									<img src = "{% static 'img/icons/refresh-white-96.png' %}">
								</div>
								<div class = "header-element nav-element dropdown-close">
									<img src = "{% static 'img/icons/close-white-56.png' %}">
								</div>
							</div>
						</div>
						<div class = "device-list">
							<div class = "device">
								<input class = "device-id" type = "hidden" value = "{{ device.id }}">
								<img src = "{% static 'img/icons/phone-white-88.png' %}">
								<div class = "device-info">
									<p class = "device-name">Nicks-PC</p>
									<p class = "device-type">Computer</p>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class = "song-control player-element previous">
					<img src = "{% static 'img/icons/rewind-white-70.png' %}">
				</div>
				<div class = "song-control player-element play">
					<img class = "play" src = "{% static 'img/icons/play-white-56.png' %}">
					<img class = "pause" src = "{% static 'img/icons/pause-white-56.png' %}">
				</div>
				<div class = "song-control player-element next">
					<img src = "{% static 'img/icons/fastforward-white-70.png' %}">
				</div>
				<div class = "player-element">
					<img src = "{% static 'img/icons/volume-white-88.png' %}">
				</div>
			</div>
		</div>
		<div id = "song-info" class = "dropdown-toggle">
			<div class = "current-song-image">
				
			</div>
			<div id = "song-details">
				<p class = "current-song-title"></p>
				<p class = "current-song-artist"></p>
			</div>
		</div>
		<div id = "song-controller">
			<div id = "song-controls">
				<div class = "song-control player-element previous">
					<img src = "{% static 'img/icons/rewind-white-70.png' %}">
				</div>
				<div class = "song-control player-element play">
					<img class = "play" src = "{% static 'img/icons/play-white-56.png' %}">
					<img class = "pause" src = "{% static 'img/icons/pause-white-56.png' %}">
				</div>
				<div class = "song-control player-element next">
					<img src = "{% static 'img/icons/fastforward-white-70.png' %}">
				</div>
			</div>
			<div class = "song-progress-container">
				<!-- <p class = "song-progress-time">- : - -</p> -->
				<p class = "song-progress-time">0:00</p>
				<div class = "song-progress progress-container row">
					<div class = "progress-complete">
						<div class = "progress-thumb">
							
						</div>
					</div>
					<div class = "progress-incomplete">
						
					</div>
				</div>
				<!-- <p class = "song-total-time">- : - -</p> -->
				<p class = "song-total-time">3:12</p>
			</div>
		</div>
		<div id = "song-extra-controls">
			<div class = "device-container dropdown-container column top right">
				<input type = "hidden" class = "dropdown-group" value = "1">
				<input type = "hidden" class = "dropdown-layer" value = "1">

				<div class = "dropdown-toggle player-element select-element icon-element">
					<img src = "{% static 'img/icons/device-white-96.png' %}">
				</div>
				<div class = "dropdown-element">
					<div class = "header no-margin">
						<div class = "header-info">
							<p>Devices</p>
						</div>
						<div class = "header-actions">
							<div class = "refresh-devices header-element nav-element">
								<img src = "{% static 'img/icons/refresh-white-96.png' %}">
							</div>
						</div>
					</div>
					<div class = "device-list">
						<div class = "device">
							<input class = "device-id" type = "hidden" value = "{{ device.id }}">
							<img src = "{% static 'img/icons/phone-white-88.png' %}">
							<div class = "device-info">
								<p class = "device-name">Nicks-PC</p>
								<p class = "device-type">Computer</p>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div id = "volume-container" class = "dropdown-container column top right">
				<input type = "hidden" class = "dropdown-group" value = "1">
				<input type = "hidden" class = "dropdown-layer" value = "1">

				<div class = "dropdown-toggle player-element select-element icon-element">
					<img src = "{% static 'img/icons/volume-white-88.png' %}">
				</div>
				<div class = "dropdown-element">
					<p>;welrfuhwlehwlefuhwleiuhal;wiefukj</p>
					<p>;welrfuhwlehwlefuhwleiuhal;wiefukj</p>
					<p>;welrfuhwlehwlefuhwleiuhal;wiefukj</p>
					<p>;welrfuhwlehwlefuhwleiuhal;wiefukj</p>
				</div>
			</div>
		</div>

		<!-- <div id = "song-info">
			<div id = "song-image">
				<img>
			</div>
			<div id = "current-song-details">
				<p id = "current-song-name"></p>
				<p id = "current-song-artist"></p>
			</div>
		</div>
		<div id = "song-controls">
			<div id = "previous" class = "song-control control">
				<img src = "{% static 'img/icons/rewind-white-24.png' %}">
			</div>
			<div id = "play-pause" class = "song-control control">
				<img class = "play" src = "{% if room_state.song_state.is_playing %}{% static 'img/icons/pause-white-24.png' %}{% else %}{% static 'img/icons/play-white-24.png' %}{% endif %}">
				<img class = "pause" src = "{% if room_state.song_state.is_playing %}{% static 'img/icons/play-white-24.png' %}{% else %}{% static 'img/icons/pause-white-24.png' %}{% endif %}">
			</div>
			<div id = "next" class = "song-control control">
				<img src = "{% static 'img/icons/fastforward-white-24.png' %}">
			</div>
		</div>
		<div id = "song-progress-container">
			<p id = "song-progress-time">- : - -</p>
			<div id = "song-progress" class = "progress-container row">
				<div class = "progress-complete">
					<div class = "progress-thumb">
						
					</div>
				</div>
				<div class = "progress-incomplete">
					
				</div>
			</div>
			<p id = "song-total-time">- : - -</p>
		</div>
		<div id = "extra-controls-container">
			<div id = "sync-playlist" class = "control item-label-trigger top">
				<img src = "{% static 'img/icons/sync-white-96.png' %}">
				<p class = "item-label">Sync Playlist</p>
			</div>
			<div class = "dropdown-container column top right">
				<div id = "history" class = "control dropdown-toggle item-label-trigger top">
					<img src = "{% static 'img/icons/history-white-96.png' %}">
					<p class = "item-label">Room History</p>
				</div>
				<div id = "history-container" class = "dropdown-element">
					<div class = "header">
						<p>History</p>
					</div>
					<div id = "history-wrapper">
						<div id = "history-entry-list">

						</div>
					</div>
				</div>
				<div id = "history-entries">
					
				</div>
			</div>
			<div class = "dropdown-container column top right">
				<div id = "devices" class = "control dropdown-toggle item-label-trigger top">
					<img id = "devices-image" src = "{% static 'img/icons/device-white-96.png' %}">
					<p class = "item-label">Devices</p>
				</div>
				<div id = "devices-container" class = "dropdown-element">
					<div class = "header">
						<p>Devices</p>
						<div id = "devices-options">
							<div id = "devices-refresh" class = "devices-option">
								<img src = "{% static 'img/icons/refresh-white-96.png' %}">
							</div>
						</div>
					</div>
					<div id = "device-list">
						
					</div>
				</div>
			</div>
			<div class = "dropdown-container column top right">
				<div id = "volume" class = "control dropdown-toggle item-label-trigger top">
					<img id = "volume-image" src = "{% static 'img/icons/speaker-white-96.png' %}">
					<p class = "item-label">Volume</p>
				</div>
				<div id = "volume-container" class = "dropdown-element">
					<div id = "volume-progress" class = "progress-container column">
						<div class = "progress-incomplete">
							
						</div>
						<div class = "progress-complete">
							<div class = "progress-thumb">
								
							</div>
						</div>
					</div>
				</div>
			</div>
		</div> -->
	</div>

{% endblock %}

{% block js %}
	{{ block.super }}

	{% static 'img/icons/pause-white-24.png' as pausePath %}
	{% static 'img/icons/play-white-24.png' as playPath %}
	{% static '' as static_url %}
	{{ room.code|json_script:"code" }}
	{{ user.username|json_script:"username" }}
	{{ room_state.song_state.is_playing|json_script:"is_playing" }}
	
	<script src = "{% static 'js/room.js' %}"></script>
	<script src = "{% static 'js/jquery-mobile.js' %}"></script>
	<script type = "text/javascript">
		var code = JSON.parse(document.getElementById('code').textContent),
			staticUrl = '{{ static_url }}',
			pausePath = '{{ pausePath }}',
			playPath = '{{ playPath }}',
			playing = "{{ room_state.song_state.is_playing }}" == "True";
	</script>

{% endblock %}