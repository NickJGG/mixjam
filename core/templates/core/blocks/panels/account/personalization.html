{% load static %}
{% load util %}

<div id = "panel-personalization" class = "panel {% if selected == True %}selected{% endif %}">
	<div id = "user-card">
		<div id = "user-card-identity">
			{% include 'core/blocks/profile-picture.html' with width='200px' height='200px' %}

			<p id = "user-identity-username">{{ user.username }}</p>
			<p id = "user-identity-tagline">{{ user.userprofile.tag_line }}</p>
		</div>
		<div id = "user-card-showcase" style = "--background-color: {{ user.userprofile.background_color }}">
			<div class = "user-showcase-group">
				{% get_rooms user as rooms %}
				{% get_room_count user as room_count %}

				<p class = "showcase-group-label">Rooms â€¢ {{ room_count }}</p>
				<div id = "user-showcase-rooms" class = "showcase-group-content">
					{% for room in rooms %}
	
						<a href = "{% url 'room' room_code=room.code %}">
							<div class = "showcase-room" style = "--background-image: url({{ room.playlist_image_url }})">

							</div>
						</a>
	
					{% endfor %}
				</div>
			</div>
		</div>
	</div>
	<div id = "settings-sections">
		<form id = "form-personalization" method = "POST">
			{% csrf_token %}

			<input type = "hidden" name = "panel-label" value = "personalization">
			<input id = "icon-image-path" type = "hidden" name = "icon-image" value = "{{ user.userprofile.icon_image }}">
			<div class = "settings-sections">
				<div class = "settings-section">
					<p class = "settings-label">Profile Picture</p>
					<div class = "settings-list">
						<div id = "setting-icon" class = "setting">
							<p class = "setting-label">Icon</p>
							<div id = "picture-choices-container">
								{% for image in images %}
						
									{% with 'img/profile//'|add:image as path %}
										<div class = "picture-choice {% if user.userprofile.icon_image in path %}selected{% endif %}" style = "--highlight-color: {{ user.userprofile.background_color }}; --icon: url({% static path %})"></div>
									{% endwith %}
						
								{% endfor %}
							</div>
						</div>
						<div class = "setting">
							<p class = "setting-label">Icon Color (Hex)</p>
							<input type = "text" name = "icon-color" value = "{{ user.userprofile.icon_color }}">
						</div>
						<div class = "setting">
							<p class = "setting-label">Background Color (Hex)</p>
							<input type = "text" name = "background-color" value = "{{ user.userprofile.background_color }}">
						</div>
						<div class = "settings-actions">
							<input type = "submit" value = "Save">
						</div>
					</div>
				</div>
			</div>
		</form>
	</div>
</div>